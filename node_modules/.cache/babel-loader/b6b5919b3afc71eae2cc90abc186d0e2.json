{"ast":null,"code":"import _objectSpread from \"/Users/admin/Desktop/visualization/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/admin/Desktop/visualization/src/App.js\";\nimport React, { Component } from 'react';\nimport MapGL, { Marker, FlyToInterpolator } from 'react-map-gl';\nimport CityPin from \"./city-pin.js\";\nimport openSocket from 'socket.io-client';\nimport CITIES from './cities.json';\nimport ashish from './ashish.json';\nimport tiki from \"./tiki.json\";\nimport a from \"./a.json\";\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport { IconLayer, PathLayer } from '@deck.gl/layers';\nimport DeckGL from '@deck.gl/react';\nimport { StaticMap } from 'react-map-gl';\nimport busicon from \"./busicon.png\";\nimport driver from \"./driver.json\";\nconst MAPBOX_ACCESS_TOKEN = 'pk.eyJ1IjoiYXM0NzIiLCJhIjoiY2p3MGFmdnVoMDhiMDQwa3RkZno4Z2NncCJ9.MssP16N-csE73s0v2p_z8A';\nconst ICON_MAPPING = {\n  marker: {\n    x: 0,\n    y: 0,\n    width: 512,\n    height: 512,\n    mask: false,\n    anchorY: 512\n  }\n};\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n\n    this._onViewportChange = viewport => this.setState({\n      viewport: _objectSpread({}, this.state.viewport, viewport)\n    });\n\n    this._resize = () => this._onViewportChange({\n      width: this.props.width || window.innerWidth,\n      height: this.props.height || window.innerHeight\n    });\n\n    this.state = {\n      viewport: {\n        latitude: 28.431108,\n        longitude: 77.036291,\n        zoom: 11,\n        bearing: 0,\n        pitch: 0,\n        width: 100,\n        height: 100\n      },\n      data: [],\n      stops: [],\n      stops1: [],\n      hoveredObject: null,\n      expandedObjects: null,\n      x: 0,\n      y: 0\n    };\n    this._onHover = this._onHover.bind(this);\n    this._onClick = this._onClick.bind(this);\n    this._closePopup = this._closePopup.bind(this);\n    this._renderhoveredItems = this._renderhoveredItems.bind(this);\n  }\n\n  _onHover(info) {\n    if (this.state.expandedObjects) {\n      return;\n    }\n\n    const x = info.x,\n          y = info.y,\n          object = info.object;\n    this.setState({\n      x,\n      y,\n      hoveredObject: object\n    });\n  }\n\n  _onClick(info) {\n    const _this$props$showClust = this.props.showCluster,\n          showCluster = _this$props$showClust === void 0 ? true : _this$props$showClust;\n    const x = info.x,\n          y = info.y,\n          objects = info.objects,\n          object = info.object;\n\n    if (object && showCluster) {\n      this.setState({\n        x,\n        y,\n        expandedObjects: objects || [object]\n      });\n    } else {\n      this._closePopup();\n    }\n  }\n\n  _closePopup() {\n    if (this.state.expandedObjects) {\n      this.setState({\n        expandedObjects: null,\n        hoveredObject: null\n      });\n    }\n  }\n\n  _renderhoveredItems() {\n    const _this$state = this.state,\n          x = _this$state.x,\n          y = _this$state.y,\n          hoveredObject = _this$state.hoveredObject,\n          expandedObjects = _this$state.expandedObjects;\n\n    if (expandedObjects) {\n      return React.createElement(\"div\", {\n        className: \"tooltip interactive\",\n        style: {\n          left: x,\n          top: y\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, expandedObjects.map(({\n        source_id,\n        source_type,\n        driver_name,\n        vehicle_number,\n        class: driver\n      }) => {\n        return React.createElement(\"div\", {\n          key: source_id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87\n          },\n          __self: this\n        }, React.createElement(\"h5\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 88\n          },\n          __self: this\n        }, source_id), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, \"Type: \", source_type || 'unknown'), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, \"Driver Name: \", driver_name), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, \"Vehicle Number \", vehicle_number));\n      }));\n    }\n\n    if (!hoveredObject) {\n      return null;\n    }\n\n    return hoveredObject && React.createElement(\"div\", {\n      className: \"tooltip\",\n      style: {\n        left: x,\n        top: y\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, hoveredObject.vehicle_number);\n  }\n\n  async componentDidMount() {\n    await fetch(\"https://service-panel-backend.shuttltech.com/api/v1/routes/125e9bde-22c0-4e5d-936d-66dcadc74174/path\", {\n      \"credentials\": \"omit\",\n      \"headers\": {\n        \"accept\": \"application/json, text/plain, */*\",\n        \"x-session-id\": \"633K4LTHCBNXWVS3DOGUW44MGH7ICKVOBNP7QUEVD5J3JRPBFVLWCZWGPESIXXV7NGNVR5RTD66X3OZYPKKOVC6DUYIBTBGVAOSEJYA\"\n      },\n      \"referrer\": \"https://service-panel.shuttltech.com/trip/01a035d8-7436-43f4-b311-9ac3916af099\",\n      \"referrerPolicy\": \"no-referrer-when-downgrade\",\n      \"body\": null,\n      \"method\": \"GET\",\n      \"mode\": \"cors\"\n    }).then(_ => _.json()).then(json => this.setState({\n      data: [{\n        path: json.data.locations.map(item => [item.lng, item.lat])\n      }],\n      stops: json.data.way_points.map(item => [item.point.location.lng, item.point.location.lat])\n    })); // const socket=openSocket(\"http://127.0.0.1:5000\");\n    // socket.on(\"my event\", data => this.setState({stops1: data}));\n\n    window.addEventListener('resize', this._resize);\n\n    this._resize();\n  }\n\n  onHover(info) {\n    this.setState({\n      hoveredItem: info\n    });\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this._resize);\n  }\n\n  _renderLayers() {\n    const layer = new PathLayer({\n      id: 'path-layer',\n      data: this.state.data,\n      pickable: true,\n      widthScale: 2,\n      widthMinPixels: 2,\n      opacity: 0.8,\n      getPath: d => d.path,\n      getColor: d => [255, 0, 0],\n      getWidth: d => 4\n    });\n    const layer1 = new IconLayer({\n      id: 'icon-layer',\n      data: a,\n      pickable: true,\n      iconAtlas: busicon,\n      iconMapping: ICON_MAPPING,\n      getIcon: d => 'marker',\n      sizeScale: 15,\n      getPosition: d => [d.longitude, d.latitude],\n      getSize: d => 4,\n      getColor: d => [14, 200, 50],\n      onHover: this._onHover\n    });\n    return [layer, layer1];\n  }\n\n  render() {\n    return React.createElement(DeckGL, {\n      initialViewState: this.state.viewport,\n      controller: true,\n      layers: this._renderLayers(),\n      onViewStateChange: this._closePopup,\n      onClick: this._onClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(StaticMap, {\n      mapboxApiAccessToken: MAPBOX_ACCESS_TOKEN,\n      mapStyle: \"mapbox://styles/mapbox/dark-v9\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }), this._renderhoveredItems);\n  }\n\n}","map":{"version":3,"sources":["/Users/admin/Desktop/visualization/src/App.js"],"names":["React","Component","MapGL","Marker","FlyToInterpolator","CityPin","openSocket","CITIES","ashish","tiki","a","IconLayer","PathLayer","DeckGL","StaticMap","busicon","driver","MAPBOX_ACCESS_TOKEN","ICON_MAPPING","marker","x","y","width","height","mask","anchorY","App","constructor","props","_onViewportChange","viewport","setState","state","_resize","window","innerWidth","innerHeight","latitude","longitude","zoom","bearing","pitch","data","stops","stops1","hoveredObject","expandedObjects","_onHover","bind","_onClick","_closePopup","_renderhoveredItems","info","object","showCluster","objects","left","top","map","source_id","source_type","driver_name","vehicle_number","class","componentDidMount","fetch","then","_","json","path","locations","item","lng","lat","way_points","point","location","addEventListener","onHover","hoveredItem","componentWillUnmount","removeEventListener","_renderLayers","layer","id","pickable","widthScale","widthMinPixels","opacity","getPath","d","getColor","getWidth","layer1","iconAtlas","iconMapping","getIcon","sizeScale","getPosition","getSize","render"],"mappings":";;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,KAAP,IAAeC,MAAf,EAAsBC,iBAAtB,QAA8C,cAA9C;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,MAAP,MAAmB,eAAnB;AACA,OAAOC,MAAP,MAAmB,eAAnB;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,OAAOC,CAAP,MAAc,UAAd;AACA,OAAO,8BAAP;AACA,SAAQC,SAAR,EAAkBC,SAAlB,QAAkC,iBAAlC;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AACA,SAAQC,SAAR,QAAwB,cAAxB;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,MAAP,MAAmB,eAAnB;AAGA,MAAMC,mBAAmB,GAAG,wFAA5B;AACA,MAAMC,YAAY,GAAG;AACnBC,EAAAA,MAAM,EAAE;AAACC,IAAAA,CAAC,EAAE,CAAJ;AAAOC,IAAAA,CAAC,EAAE,CAAV;AAAaC,IAAAA,KAAK,EAAE,GAApB;AAAyBC,IAAAA,MAAM,EAAE,GAAjC;AAAsCC,IAAAA,IAAI,EAAE,KAA5C;AAAmDC,IAAAA,OAAO,EAAE;AAA5D;AADW,CAArB;AAKA,eAAe,MAAMC,GAAN,SAAkBzB,SAAlB,CAA4B;AAEzC0B,EAAAA,WAAW,CAACC,KAAD,EACT;AACE,UAAMA,KAAN;;AADF,SA2GFC,iBA3GE,GA2GkBC,QAAQ,IAAI,KAAKC,QAAL,CAAc;AAC5CD,MAAAA,QAAQ,oBAAM,KAAKE,KAAL,CAAWF,QAAjB,EAA8BA,QAA9B;AADoC,KAAd,CA3G9B;;AAAA,SA8IJG,OA9II,GA8IM,MAAM,KAAKJ,iBAAL,CAAuB;AACnCP,MAAAA,KAAK,EAAE,KAAKM,KAAL,CAAWN,KAAX,IAAoBY,MAAM,CAACC,UADC;AAEnCZ,MAAAA,MAAM,EAAE,KAAKK,KAAL,CAAWL,MAAX,IAAqBW,MAAM,CAACE;AAFD,KAAvB,CA9IZ;;AAEE,SAAKJ,KAAL,GAAW;AACTF,MAAAA,QAAQ,EAAE;AACVO,QAAAA,QAAQ,EAAE,SADA;AAEVC,QAAAA,SAAS,EAAE,SAFD;AAGZC,QAAAA,IAAI,EAAE,EAHM;AAIZC,QAAAA,OAAO,EAAE,CAJG;AAKZC,QAAAA,KAAK,EAAE,CALK;AAMZnB,QAAAA,KAAK,EAAE,GANK;AAOZC,QAAAA,MAAM,EAAE;AAPI,OADD;AAUbmB,MAAAA,IAAI,EAAC,EAVQ;AAWbC,MAAAA,KAAK,EAAC,EAXO;AAYbC,MAAAA,MAAM,EAAC,EAZM;AAabC,MAAAA,aAAa,EAAE,IAbF;AAcbC,MAAAA,eAAe,EAAE,IAdJ;AAeb1B,MAAAA,CAAC,EAAC,CAfW;AAgBbC,MAAAA,CAAC,EAAC;AAhBW,KAAX;AAkBF,SAAK0B,QAAL,GAAgB,KAAKA,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKC,QAAL,GAAgB,KAAKA,QAAL,CAAcD,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKE,WAAL,GAAmB,KAAKA,WAAL,CAAiBF,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKG,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBH,IAAzB,CAA8B,IAA9B,CAA3B;AACC;;AAGHD,EAAAA,QAAQ,CAACK,IAAD,EAAO;AACb,QAAI,KAAKpB,KAAL,CAAWc,eAAf,EAAgC;AAC9B;AACD;;AAHY,UAKN1B,CALM,GAKUgC,IALV,CAKNhC,CALM;AAAA,UAKHC,CALG,GAKU+B,IALV,CAKH/B,CALG;AAAA,UAKAgC,MALA,GAKUD,IALV,CAKAC,MALA;AAMb,SAAKtB,QAAL,CAAc;AAACX,MAAAA,CAAD;AAAIC,MAAAA,CAAJ;AAAOwB,MAAAA,aAAa,EAAEQ;AAAtB,KAAd;AACD;;AAEDJ,EAAAA,QAAQ,CAACG,IAAD,EAAO;AAAA,kCACgB,KAAKxB,KADrB,CACN0B,WADM;AAAA,UACNA,WADM,sCACQ,IADR;AAAA,UAENlC,CAFM,GAEmBgC,IAFnB,CAENhC,CAFM;AAAA,UAEHC,CAFG,GAEmB+B,IAFnB,CAEH/B,CAFG;AAAA,UAEAkC,OAFA,GAEmBH,IAFnB,CAEAG,OAFA;AAAA,UAESF,MAFT,GAEmBD,IAFnB,CAESC,MAFT;;AAIb,QAAIA,MAAM,IAAIC,WAAd,EAA2B;AACzB,WAAKvB,QAAL,CAAc;AAACX,QAAAA,CAAD;AAAIC,QAAAA,CAAJ;AAAOyB,QAAAA,eAAe,EAAES,OAAO,IAAI,CAACF,MAAD;AAAnC,OAAd;AACD,KAFD,MAEO;AACL,WAAKH,WAAL;AACD;AACF;;AAEDA,EAAAA,WAAW,GAAG;AACZ,QAAI,KAAKlB,KAAL,CAAWc,eAAf,EAAgC;AAC9B,WAAKf,QAAL,CAAc;AAACe,QAAAA,eAAe,EAAE,IAAlB;AAAwBD,QAAAA,aAAa,EAAE;AAAvC,OAAd;AACD;AACF;;AAEDM,EAAAA,mBAAmB,GAAG;AAAA,wBAC0B,KAAKnB,KAD/B;AAAA,UACbZ,CADa,eACbA,CADa;AAAA,UACVC,CADU,eACVA,CADU;AAAA,UACPwB,aADO,eACPA,aADO;AAAA,UACOC,eADP,eACOA,eADP;;AAGpB,QAAIA,eAAJ,EAAqB;AACnB,aACE;AAAK,QAAA,SAAS,EAAC,qBAAf;AAAqC,QAAA,KAAK,EAAE;AAACU,UAAAA,IAAI,EAAEpC,CAAP;AAAUqC,UAAAA,GAAG,EAAEpC;AAAf,SAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGyB,eAAe,CAACY,GAAhB,CAAoB,CAAC;AAACC,QAAAA,SAAD;AAAWC,QAAAA,WAAX;AAAwBC,QAAAA,WAAxB;AAAoCC,QAAAA,cAApC;AAAoDC,QAAAA,KAAK,EAAE/C;AAA3D,OAAD,KAAwE;AAC3F,eACE;AAAK,UAAA,GAAG,EAAE2C,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAKA,SAAL,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAYC,WAAW,IAAI,SAA3B,CAFF,EAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAmBC,WAAnB,CAHF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BAAqBC,cAArB,CAJF,CADF;AAQD,OATA,CADH,CADF;AAcD;;AAED,QAAI,CAACjB,aAAL,EAAoB;AAClB,aAAO,IAAP;AACD;;AACC,WAAOA,aAAa,IAClB;AAAK,MAAA,SAAS,EAAC,SAAf;AAAyB,MAAA,KAAK,EAAE;AAACW,QAAAA,IAAI,EAAEpC,CAAP;AAAUqC,QAAAA,GAAG,EAAEpC;AAAf,OAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACMwB,aAAa,CAACiB,cADpB,CADF;AAKH;;AAED,QAAME,iBAAN,GAA0B;AACxB,UACAC,KAAK,CAAC,sGAAD,EACL;AAAC,qBAAc,MAAf;AAAsB,iBAAU;AAAC,kBAAS,mCAAV;AAA8C,wBAC9E;AADgC,OAAhC;AAEC,kBAAW,gFAFZ;AAE6F,wBAC7F,4BAHA;AAG6B,cAAO,IAHpC;AAGyC,gBAAS,KAHlD;AAGwD,cAAO;AAH/D,KADK,CAAL,CAKCC,IALD,CAKMC,CAAC,IAAIA,CAAC,CAACC,IAAF,EALX,EAKqBF,IALrB,CAK0BE,IAAI,IAAG,KAAKrC,QAAL,CAAc;AAACW,MAAAA,IAAI,EAAE,CAAC;AAAC2B,QAAAA,IAAI,EAAED,IAAI,CAAC1B,IAAL,CAAU4B,SAAV,CAAoBZ,GAApB,CAAwBa,IAAI,IAAG,CAACA,IAAI,CAACC,GAAN,EAAUD,IAAI,CAACE,GAAf,CAA/B;AAAP,OAAD,CAAP;AAAsE9B,MAAAA,KAAK,EAACyB,IAAI,CAAC1B,IAAL,CAAUgC,UAAV,CAAqBhB,GAArB,CAAyBa,IAAI,IAAG,CAACA,IAAI,CAACI,KAAL,CAAWC,QAAX,CAAoBJ,GAArB,EAAyBD,IAAI,CAACI,KAAL,CAAWC,QAAX,CAAoBH,GAA7C,CAAhC;AAA5E,KAAd,CALjC,CADA,CADwB,CAUxB;AACA;;AACAvC,IAAAA,MAAM,CAAC2C,gBAAP,CAAwB,QAAxB,EAAkC,KAAK5C,OAAvC;;AACA,SAAKA,OAAL;AACD;;AAED6C,EAAAA,OAAO,CAAC1B,IAAD,EAAO;AACd,SAAKrB,QAAL,CAAc;AAACgD,MAAAA,WAAW,EAAE3B;AAAd,KAAd;AACD;;AAEC4B,EAAAA,oBAAoB,GAAG;AACrB9C,IAAAA,MAAM,CAAC+C,mBAAP,CAA2B,QAA3B,EAAqC,KAAKhD,OAA1C;AACD;;AAMDiD,EAAAA,aAAa,GAAE;AAEX,UAAMC,KAAK,GAAG,IAAIvE,SAAJ,CAAc;AAC5BwE,MAAAA,EAAE,EAAE,YADwB;AAE5B1C,MAAAA,IAAI,EAAE,KAAKV,KAAL,CAAWU,IAFW;AAG5B2C,MAAAA,QAAQ,EAAE,IAHkB;AAI5BC,MAAAA,UAAU,EAAE,CAJgB;AAK5BC,MAAAA,cAAc,EAAE,CALY;AAM5BC,MAAAA,OAAO,EAAE,GANmB;AAO5BC,MAAAA,OAAO,EAAEC,CAAC,IAAKA,CAAC,CAACrB,IAPW;AAQ5BsB,MAAAA,QAAQ,EAAED,CAAC,IAAI,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,CARa;AAS5BE,MAAAA,QAAQ,EAAEF,CAAC,IAAI;AATa,KAAd,CAAd;AAYA,UAAMG,MAAM,GAAG,IAAIlF,SAAJ,CAAc;AAC7ByE,MAAAA,EAAE,EAAE,YADyB;AAE7B1C,MAAAA,IAAI,EAAEhC,CAFuB;AAG7B2E,MAAAA,QAAQ,EAAE,IAHmB;AAI7BS,MAAAA,SAAS,EAAE/E,OAJkB;AAK7BgF,MAAAA,WAAW,EAAE7E,YALgB;AAM7B8E,MAAAA,OAAO,EAAEN,CAAC,IAAI,QANe;AAO7BO,MAAAA,SAAS,EAAE,EAPkB;AAQ7BC,MAAAA,WAAW,EAAER,CAAC,IAAI,CAACA,CAAC,CAACpD,SAAH,EAAaoD,CAAC,CAACrD,QAAf,CARW;AAS7B8D,MAAAA,OAAO,EAAET,CAAC,IAAI,CATe;AAU7BC,MAAAA,QAAQ,EAAED,CAAC,IAAI,CAAC,EAAD,EAAK,GAAL,EAAU,EAAV,CAVc;AAW7BZ,MAAAA,OAAO,EAAE,KAAK/B;AAXe,KAAd,CAAf;AAcF,WAAO,CAACoC,KAAD,EAAOU,MAAP,CAAP;AACH;;AAOCO,EAAAA,MAAM,GAAG;AACP,WACE,oBAAC,MAAD;AACE,MAAA,gBAAgB,EAAE,KAAKpE,KAAL,CAAWF,QAD/B;AAEE,MAAA,UAAU,EAAE,IAFd;AAGE,MAAA,MAAM,EAAE,KAAKoD,aAAL,EAHV;AAIE,MAAA,iBAAiB,EAAE,KAAKhC,WAJ1B;AAKE,MAAA,OAAO,EAAE,KAAKD,QALhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOE,oBAAC,SAAD;AAAW,MAAA,oBAAoB,EAAEhC,mBAAjC;AACC,MAAA,QAAQ,EAAC,gCADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EASG,KAAKkC,mBATR,CADF;AAaD;;AApKwC","sourcesContent":["import React, {Component} from 'react';\nimport MapGL, {Marker,FlyToInterpolator} from 'react-map-gl';\nimport CityPin from \"./city-pin.js\";\nimport openSocket from 'socket.io-client';\nimport CITIES from './cities.json';\nimport ashish from './ashish.json'\nimport tiki from \"./tiki.json\"\nimport a from \"./a.json\"\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport {IconLayer,PathLayer} from '@deck.gl/layers';\nimport DeckGL from '@deck.gl/react';\nimport {StaticMap} from 'react-map-gl';\nimport busicon from \"./busicon.png\";\nimport driver from \"./driver.json\"\n\n\nconst MAPBOX_ACCESS_TOKEN = 'pk.eyJ1IjoiYXM0NzIiLCJhIjoiY2p3MGFmdnVoMDhiMDQwa3RkZno4Z2NncCJ9.MssP16N-csE73s0v2p_z8A'; \nconst ICON_MAPPING = {\n  marker: {x: 0, y: 0, width: 512, height: 512, mask: false, anchorY: 512}\n};\n\n\nexport default class App extends Component {\n  \n  constructor(props)\n    {\n      super(props);\n      this.state={\n        viewport: {\n        latitude: 28.431108,\n        longitude: 77.036291,\n      zoom: 11,\n      bearing: 0,\n      pitch: 0,\n      width: 100,\n      height: 100\n    },\n    data:[],\n    stops:[],\n    stops1:[],\n    hoveredObject: null,\n    expandedObjects: null,\n    x:0,\n    y:0\n    }\n    this._onHover = this._onHover.bind(this);\n    this._onClick = this._onClick.bind(this);\n    this._closePopup = this._closePopup.bind(this);\n    this._renderhoveredItems = this._renderhoveredItems.bind(this);\n    }\n  \n\n  _onHover(info) {\n    if (this.state.expandedObjects) {\n      return;\n    }\n\n    const {x, y, object} = info;\n    this.setState({x, y, hoveredObject: object});\n  }\n\n  _onClick(info) {\n    const {showCluster = true} = this.props;\n    const {x, y, objects, object} = info;\n\n    if (object && showCluster) {\n      this.setState({x, y, expandedObjects: objects || [object]});\n    } else {\n      this._closePopup();\n    }\n  }\n\n  _closePopup() {\n    if (this.state.expandedObjects) {\n      this.setState({expandedObjects: null, hoveredObject: null});\n    }\n  }\n\n  _renderhoveredItems() {\n    const {x, y, hoveredObject,expandedObjects} = this.state;\n\n    if (expandedObjects) {\n      return (\n        <div className=\"tooltip interactive\" style={{left: x, top: y}}>\n          {expandedObjects.map(({source_id,source_type, driver_name,vehicle_number, class: driver}) => {\n            return (\n              <div key={source_id}>\n                <h5>{source_id}</h5>\n                <div>Type: {source_type || 'unknown'}</div>\n                <div>Driver Name: {driver_name}</div>\n                <div>Vehicle Number {vehicle_number}</div>\n              </div>\n            );\n          })}\n        </div>\n      );\n    }\n\n    if (!hoveredObject) {\n      return null;\n    }\n      return hoveredObject && (\n        <div className=\"tooltip\" style={{left: x, top: y}}>\n            { hoveredObject.vehicle_number }\n        </div>\n      );\n  }\n\n  async componentDidMount() {\n    await\n    fetch(\"https://service-panel-backend.shuttltech.com/api/v1/routes/125e9bde-22c0-4e5d-936d-66dcadc74174/path\", \n    {\"credentials\":\"omit\",\"headers\":{\"accept\":\"application/json, text/plain, */*\",\"x-session-id\":\n    \"633K4LTHCBNXWVS3DOGUW44MGH7ICKVOBNP7QUEVD5J3JRPBFVLWCZWGPESIXXV7NGNVR5RTD66X3OZYPKKOVC6DUYIBTBGVAOSEJYA\"}\n    ,\"referrer\":\"https://service-panel.shuttltech.com/trip/01a035d8-7436-43f4-b311-9ac3916af099\",\"referrerPolicy\":\n    \"no-referrer-when-downgrade\",\"body\":null,\"method\":\"GET\",\"mode\":\"cors\"})\n    .then(_ => _.json()).then(json =>this.setState({data: [{path: json.data.locations.map(item=> [item.lng,item.lat])}], stops:json.data.way_points.map(item=> [item.point.location.lng,item.point.location.lat])}));\n    \n\n    // const socket=openSocket(\"http://127.0.0.1:5000\");\n    // socket.on(\"my event\", data => this.setState({stops1: data}));\n    window.addEventListener('resize', this._resize);\n    this._resize();\n  }\n\n  onHover(info) {\n  this.setState({hoveredItem: info});\n}\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this._resize);\n  }\n\n  _onViewportChange = viewport => this.setState({\n    viewport: {...this.state.viewport, ...viewport}\n  });\n\n  _renderLayers(){\n    \n      const layer = new PathLayer({\n      id: 'path-layer',\n      data: this.state.data,\n      pickable: true,\n      widthScale: 2,\n      widthMinPixels: 2,\n      opacity: 0.8,\n      getPath: d =>  d.path,\n      getColor: d => [255,0,0],\n      getWidth: d => 4\n    });\n\n      const layer1 = new IconLayer({\n      id: 'icon-layer',\n      data: a,\n      pickable: true,\n      iconAtlas: busicon,\n      iconMapping: ICON_MAPPING,\n      getIcon: d => 'marker',\n      sizeScale: 15,\n      getPosition: d => [d.longitude,d.latitude],\n      getSize: d => 4,\n      getColor: d => [14, 200, 50],\n      onHover: this._onHover\n      });\n\n    return [layer,layer1];\n}\n\n_resize = () => this._onViewportChange({\n    width: this.props.width || window.innerWidth,\n    height: this.props.height || window.innerHeight\n  });\n\n  render() {\n    return (\n      <DeckGL\n        initialViewState={this.state.viewport}\n        controller={true}\n        layers={this._renderLayers()}\n        onViewStateChange={this._closePopup}\n        onClick={this._onClick}\n      >\n        <StaticMap mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\n         mapStyle=\"mapbox://styles/mapbox/dark-v9\" />\n        {this._renderhoveredItems}\n      </DeckGL>\n      );\n  }\n}"]},"metadata":{},"sourceType":"module"}